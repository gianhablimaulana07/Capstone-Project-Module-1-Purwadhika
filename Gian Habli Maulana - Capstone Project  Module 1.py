# Database Rumah Sakit Umum Purwadhika

## Data Administrasi Pasien
data_adm_pasien = [{'id':10001,'nama': 'Amin Kurniawan', 'usia': 55, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Mengger Hilir, No. 1, Bandung', 'pekerjaan': 'Pedagang', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'Tunai'},
                   {'id':10002,'nama': 'Heni Mustika', 'usia': 50, 'jenis_kelamin': 'Wanita', 'alamat': 'Jalan Ciwaruga, No. 11, Bandung', 'pekerjaan': 'Ibu Rumah Tangga', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'BPJS'},
                   {'id':10003,'nama': 'Tatang Sutarman', 'usia': 60, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Turangga, No. 101, Bandung', 'pekerjaan': 'Dosen', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'BPJS'},
                   {'id':10004,'nama': 'Indra Gunawan', 'usia': 40, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Dayeuhkolot, No. 71, Bandung', 'pekerjaan': 'Guru', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'Asuransi'},
                   {'id':10005,'nama': 'Solihati', 'usia': 49, 'jenis_kelamin': 'Wanita', 'alamat': 'Jalan Baleendah, No. 9, Bandung', 'pekerjaan': 'Laboran', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'BPJS'},
                   {'id':10006,'nama': 'Dadang Rahmat', 'usia': 51, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Tarogong, No. 19, Bandung', 'pekerjaan': 'Buruh Pabrik', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'Tunai'},
                   {'id':10007,'nama': 'Queensha Aqila', 'usia': 1, 'jenis_kelamin': 'Wanita', 'alamat': 'Jalan Mengger Tengah, No. 91, Bandung', 'pekerjaan': 'Belum Bekerja', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'BPJS'},
                   {'id':10008,'nama': 'Lulu Alafah', 'usia': 1, 'jenis_kelamin': 'Wanita', 'alamat': 'Jalan Derwati, No. 10, Bandung', 'pekerjaan': 'Belum Bekerja', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'BPJS'},
                   {'id':10009,'nama': 'Didin Rosidin', 'usia': 49, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Punclut, No. 21, Bandung', 'pekerjaan': 'Guru', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'BPJS'},
                   {'id':10010,'nama': 'Muadz Alfaruq', 'usia': 13, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Banda, No. 19, Bandung', 'pekerjaan': 'Pelajar', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'Asuransi'},
                   {'id':10011,'nama': 'Fadel Muhammad', 'usia': 20, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Ciwaruga, No. 20, Bandung', 'pekerjaan': 'Mahasiswa', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'BPJS'},
                   {'id':10012,'nama': 'Ramdhani', 'usia': 9, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Sarijadi, No. 22, Bandung', 'pekerjaan': 'Pelajar', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'Asuransi'},
                   {'id':10013,'nama': 'Paulo Sitanggang', 'usia': 27, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Cikaso, No. 33, Bandung', 'pekerjaan': 'Seniman', 'tipe_kunjungan': 'Poliklinik', 'tipe_bayar': 'BPJS'},
                   {'id':10014,'nama': 'Ruben Sanadi', 'usia': 40, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Banjaran, No. 9, Bandung', 'pekerjaan': 'Pedagang', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'Tunai'},
                   {'id':10015,'nama': 'Fitria Risadi', 'usia': 32, 'jenis_kelamin': 'Wanita', 'alamat': 'Jalan Ciparay, No. 12, Bandung', 'pekerjaan': 'Dosen', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'Tunai'},
                   {'id':10016,'nama': 'Rezaldi', 'usia': 11, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Ciwastra, No. 12, Bandung', 'pekerjaan': 'Pelajar', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'BPJS'},
                   {'id':10017,'nama': 'Rustami Ariyanti', 'usia': 49, 'jenis_kelamin': 'Wanita', 'alamat': 'Jalan Cisaat, No. 2, Bandung', 'pekerjaan': 'Buruh Pabrik', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'BPJS'},
                   {'id':10018,'nama': 'Solihin', 'usia': 52, 'jenis_kelamin': 'Pria', 'alamat': 'Jalan Sukabumi, No. 9, Bandung', 'pekerjaan': 'Dosen', 'tipe_kunjungan': 'Rawat', 'tipe_bayar': 'Tunai'},]

## Data Rekam Medik Pasien Poliklinik
data_poli_pasien = [{'id' : 10001, 'poli' : 'mata', 'dokter':'dr. Elisa Dolah, Sp.M', 'keluhan':'katarak'},
                    {'id' : 10003, 'poli' : 'dalam', 'dokter':'dr. Gugun Gunadi, Sp.PD', 'keluhan':'diabetes'},
                    {'id' : 10006, 'poli' : 'dalam', 'dokter':'dr. Toto Suroto, Sp.PD', 'keluhan':'TBC'},
                    {'id' : 10007, 'poli' : 'anak', 'dokter':'dr. Yasmar Alfa, Sp.A (K)', 'keluhan':'imuniasasi'},
                    {'id' : 10008, 'poli' : 'anak', 'dokter':'dr. Yasmar Alfa, Sp.A (K)', 'keluhan':'imuniasasi'},
                    {'id' : 10009, 'poli' : 'dalam', 'dokter':'dr. Tiara Kasih, Sp.PD', 'keluhan':'asam urat'},
                    {'id' : 10010, 'poli' : 'gigi', 'dokter':'drg. Andini Hutagaol', 'keluhan':'pasang behel'},
                    {'id' : 10011, 'poli' : 'gigi', 'dokter':'drg. Anang Maruf', 'keluhan':'scalling gigi'},
                    {'id' : 10012, 'poli' : 'THT', 'dokter':'dr. Otto Iskandar, Sp.THT-KL', 'keluhan':'sinusitis'},
                    {'id' : 10013, 'poli' : 'THT', 'dokter':'dr. Lala Nurlaela, Sp.THT-KL', 'keluhan':'infeksi telinga'}]

## Data Rekam Medik Pasien Rawat Inap
data_inap_pasien = [{'id' : 10002, 'ruangan' : 'Purwa', 'keluhan':'DBD','status':'rawat'},
                    {'id' : 10004, 'ruangan' : 'Dhika', 'keluhan':'Tifus', 'status':'pulang'},
                    {'id' : 10005, 'ruangan' : 'ICU', 'keluhan':'Kecelakaan Lalu Lintas', 'status':'rawat'},
                    {'id' : 10014, 'ruangan' : 'Purwa', 'keluhan':'DBD', 'status':'pulang'},
                    {'id' : 10015, 'ruangan' : 'Dhika', 'keluhan':'Pneumonia', 'status':'rawat'},
                    {'id' : 10016, 'ruangan' : 'Junior', 'keluhan':'Usus Buntu', 'status':'rawat'},
                    {'id' : 10017, 'ruangan' : 'Purwa', 'keluhan':'Kecelakaan Kerja', 'status':'pulang'},
                    {'id' : 10018, 'ruangan' : 'ICU', 'keluhan':'Stroke', 'status':'rawat'}]


## Daftar dan Jadwal Dokter Poliklinik
list_dokter = [{'nama': 'drg. Andini Hutagaol', 'poli': 'gigi', 'jadwal' : 'senin', 'pukul' : '08.00-11.00'},
               {'nama': 'drg. Anang Maruf', 'poli': 'gigi', 'jadwal' : 'rabu', 'pukul' : '11.00-14.00'},
               {'nama': 'dr. Gugun Gunadi, Sp.PD', 'poli': 'dalam', 'jadwal' : 'selasa', 'pukul' : '08.00-11.00'},
               {'nama': 'dr. Toto Suroto, Sp.PD', 'poli': 'dalam', 'jadwal' : 'rabu', 'pukul' : '09.00-12.00'},
               {'nama': 'dr. Tiara Kasih, Sp.PD', 'poli': 'dalam', 'jadwal' : 'jumat', 'pukul' : '13.00-16.00'},
               {'nama': 'dr. Elisa Dolah, Sp.M', 'poli': 'mata', 'jadwal' : 'kamis', 'pukul' : '09.00-11.00'},
               {'nama': 'dr. Otto Iskandar, Sp.THT-KL', 'poli': 'THT', 'jadwal' : 'senin', 'pukul' : '11.00-14.00'},
               {'nama': 'dr. Lala Nurlaela, Sp.THT-KL', 'poli': 'THT', 'jadwal' : 'selasa', 'pukul' : '13.00-16.00'},
               {'nama': 'dr. Yasmar Alfa, Sp.A (K)', 'poli': 'anak', 'jadwal' : 'jumat', 'pukul' : '08.00-11.00'}]

## Daftar Ruangan Rawat Inap
list_ruangan = [{'ruangan' : 'Purwa'},
                {'ruangan' : 'Dhika'},
                {'ruangan' : 'Junior'},
                {'ruangan' : 'ICU'}]


#Daftar Def Function

## Fungsi Menampilkan Database

### Display Data Administrasi Pasien
def display_data_pasien(id = 0):
    if len(data_adm_pasien) != 0:
        print()
        print("DAFTAR DATA ADMINISTRASI PASIEN RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(178*"=")
        print(f"| {' ID':<5} | {'      NAMA PASIEN':<25} | {'USIA':<4} | {'JENIS KELAMIN':<14} | {'                      ALAMAT':<55} | {'      PEKERJAAN':<25} | {'TIPE KUNJUNGAN':<15} | {'TIPE BAYAR':<10} |")
        print(178*"=")

        if id == 0:
          for i in data_adm_pasien:
            print(f'| {i["id"]:<5} | {i["nama"].capitalize():<25} | {i["usia"]:<4} | {i["jenis_kelamin"].capitalize():<14} | {i["alamat"]:<55} | {i["pekerjaan"].capitalize():<25} | {i["tipe_kunjungan"].capitalize():<15} | {i["tipe_bayar"].capitalize():<10} |')     
          print(178*"=")
          print()

        else:
          for i in data_adm_pasien:
            if i["id"] == id :
              print(f'| {i["id"]:<5} | {i["nama"].capitalize():<25} | {i["usia"]:<4} | {i["jenis_kelamin"].capitalize():<14} | {i["alamat"]:<55} | {i["pekerjaan"].capitalize():<25} | {i["tipe_kunjungan"].capitalize():<15} | {i["tipe_bayar"].capitalize():<10} |')
          print(178*"=")
          print()

    else :
        print("Data Pasien Tidak Tersedia")

### Display Data Rekam Medik Pasien Poliklinik
def display_pasien_poli(id = 0):
    if len(data_poli_pasien) != 0:
        print()
        print("            DAFTAR PASIEN POLIKLINIK RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(86*"=")
        print(f"| {' ID':<5} | {'  POLI':<8} | {'         DOKTER':<30} | {'           KELUHAN':<30} |")
        print(86*"=")

        if id == 0:
          for i in data_poli_pasien:
              print(f'| {i["id"]:<5} | {i["poli"].upper():<8} | {(i["dokter"]):<30} | {(i["keluhan"]).capitalize():<30} |')
          print(86*"=")
          print()

        else:
          for i in data_poli_pasien:
            if i["id"] == id :
              print(f'| {i["id"]:<5} | {i["poli"].upper():<8} | {(i["dokter"]):<30} | {(i["keluhan"]).capitalize():<30} |')
          print(86*"=")
          print()

    else :
        print("Data Pasien Tidak Tersedia")

### Display Data Rekam Medik Pasien Rawat Inap
def display_pasien_rawat(id = 0):
    if len(data_inap_pasien) != 0:
        print()
        print("            DAFTAR PASIEN RAWAT INAP RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(64*"=")
        print(f"| {' ID':<5} | {'RUANGAN':<8} | {'           KELUHAN':<30} | {'STATUS':<8} |")
        print(64*"=")

        if id == 0:
          for i in data_inap_pasien:
              print(f'| {i["id"]:<5} | {i["ruangan"].capitalize():<8} | {(i["keluhan"]):<30} | {(i["status"]).capitalize():<8} |')
          print(64*"=")
          print()

        else:
          for i in data_inap_pasien:
            if i["id"] == id :
              print(f'| {i["id"]:<5} | {i["ruangan"].capitalize():<8} | {(i["keluhan"]):<30} | {(i["status"]).capitalize():<8} |')
          print(64*"=")
          print()

    else :
        print("Data Pasien Tidak Tersedia")


### DIsplay Daftar dan Jadwal Dokter Poliklinik
def display_dokter():
        print()
        print("             DAFTAR DOKTER POLIKLINIK RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(81*"=")
        print(f"| {'NOMOR':<5} | {'           NAMA':<30} | {'SPESIALIS':<10} | {' JADWAL':<8} | {'    PUKUL':<12} |")
        print(81*"=")
        for index, i in enumerate(list_dokter):
            print(f'| {index+1:<5} | {i["nama"]:<30} | {(i["poli"]).upper():<10} | {(i["jadwal"]).capitalize():<8} | {(i["pukul"]).capitalize():<12} |')
        print(81*"=")
        print()

### Display Daftar Ruangan Rawat Inap
def display_ruangan():
        print()
        print("DAFTAR NAMA RUANGAN RAWAT INAP RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(25*"=")
        print(f"| {'NOMOR':<5} | {'NAMA RUANGAN':<13} |")
        print(25*"=")
        for index, i in enumerate(list_ruangan):
            print(f'| {index+1:<5} | {i["ruangan"]:<13} |')
        print(25*"=")
        print()

### Display Jumlah Pasien Poliklinik
def hitung_dokter(data):
  global dokter_dict
  dokter_dict = {}
  for d in data:
    dokter = d['dokter']
    if dokter in dokter_dict:
        dokter_dict[dokter] += 1
    else:
        dokter_dict[dokter] = 1

  return dokter_dict

def display_jumlah_pasien_poli():
        print()
        print("DATA JUMLAH PASIEN POLIKLINIK PER DOKTER RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(50*"=")
        print(f"| {'         DOKTER':<30} | {'JUMLAH PASIEN':<13} |")
        print(50*"=")

        for key, val in hitung_dokter(data_poli_pasien).items() :
            print(f'| {(key):<30} | {(val):<13} |')
        print(50*"=")
        print()


### Display Jumlah Ketersediaan Ruangan Rawat Inap 
def hitung_ketersediaan_ruangan(data_inap_pasien):
    kapasitas_ruangan = {'Purwa': 5, 'Dhika': 5, 'Junior': 5, 'ICU': 5}
    keterisian_ruangan = {}

    for pasien in data_inap_pasien:
        if pasien['status'] == 'rawat':
            ruangan = pasien['ruangan']
            if ruangan in kapasitas_ruangan:
                if ruangan not in keterisian_ruangan:
                    keterisian_ruangan[ruangan] = 1
                else:
                    keterisian_ruangan[ruangan] += 1

    for ruangan, jumlah_pasien in keterisian_ruangan.items():
        kapasitas_ruangan[ruangan] -= jumlah_pasien

    return kapasitas_ruangan

def display_ketersediaan_rawat():
        print()
        print("DATA KETERSEDIAAN RUANGAN RAWAT INAP RUMAH SAKIT UMUM PURWADHIKA")
        print()
        print(41*"=")
        print(f"| {'NAMA RUANGAN':<12} | {'JUMLAH TERSEDIA (BED)':<22} |")
        print(41*"=")

        for key, val in hitung_ketersediaan_ruangan(data_inap_pasien).items() :
            print(f'| {(key):<12} | {(val):<22} |')
        print(41*"=")
        print('*Setiap Ruangan Memiliki Kapasitas Maksimal 5 Bed')
        print()

## Fungsi Memfilter Database

### Filter Data Administrasi Pasien
def filter_id_pasien(id, option='read'):
    data_pasien = list(filter(lambda i: i if i['id'] == id else '', data_adm_pasien))

    if len(data_pasien) > 0:
        if option == 'edit':
            display_data_pasien(id)
            update_data_adm(data_pasien)

        elif option == 'delete':
            display_data_pasien(id)
            delete_data_adm(data_pasien)

        elif option == 'read' :
            display_data_pasien(id)
    else:
        print(f"Data Pasien dengan ID {id} Tidak Tersedia")

### Filter Data Rekam Medik Pasien Poliklinik
def filter_id_pasien_poli(id, option='read'):
    data_pasien = list(filter(lambda i: i if i['id'] == id else '', data_poli_pasien))

    if len(data_pasien) > 0:
        if option == 'edit':
            display_pasien_poli(id)
            update_data_poli(data_pasien)

        elif option == 'delete':
            display_pasien_poli(id)
            delete_data_poli(data_pasien)

        elif option == 'read' :
            display_pasien_poli(id)
    else:
        print(f"Data Pasien dengan ID {id} Tidak Tersedia")

### Filter Data Rekam Medik Pasien Rawat Inap
def filter_id_pasien_rawat(id, option='read'):
    data_pasien = list(filter(lambda i: i if i['id'] == id else '', data_inap_pasien))

    if len(data_pasien) > 0:
        if option == 'edit':
            display_pasien_rawat(id)
            update_data_rawat(data_pasien)

        elif option == 'delete':
            display_pasien_rawat(id)
            delete_data_rawat(data_pasien)

        elif option == 'read' :
            display_pasien_rawat(id)
    else:
        print(f"Data Pasien dengan ID {id} Tidak Tersedia")

## Fungsi Meng-update Database

### Update Data Administrasi Pasien
def update_data_adm(data):
    index = data_adm_pasien.index(data[0])
    while True :
        edit_input = input(f"Apakah Anda Ingin Meng-update Data Pasien Berdasarkan ID Pasien {data[0]['id']} (Ya / Tidak) : ")
        if edit_input.lower() == 'ya'    :
            while True:
                menu_edit = input('''
Pilih kolom yang ingin diupdate
1. Nama
2. Jenis Kelamin
3. Usia
4. Alamat
5. Pekerjaan
6. Tipe Bayar
7. Kembali Ke Menu Update

Masukkan angka kolom yang ingin diupdate : ''')

                if menu_edit == '1':
                    new_name = input("Masukkan Nama Pasien : \n")
                    while not validate_name(new_name):
                        print("Nama Hanya Terdiri dari Huruf Alfabet\n")
                        new_name = input("Masukkan Nama Pasien : \n")

                    print(f"Data Nama Pasien Berubah dari {data[0]['nama']} Menjadi {new_name}\n")

                    while True:
                        confirm_name = input("Apakah Perubahan Nama Pasien Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_name.lower() == 'ya'   :
                           data_adm_pasien[index]['nama'] = new_name
                           print("Proses Update Nama Pasien Berhasil\n")
                           display_data_pasien(data_adm_pasien[index]['id'])
                           break

                        elif confirm_name.lower() == 'tidak' :
                           break
                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '2':
                    new_gender = input("Masukkan Jenis Kelamin Pasien (Pria / Wanita) : \n")
                    while not validate_gender(new_gender):
                        print("Jenis Kelamin Hanya Dapat Diisi Pria atau Wanita\n")
                        new_gender = input("Masukkan Jenis Kelamin Pasien (Pria / Wanita) : \n")

                    print(f"Data Jenis Kelamin Pasien Berubah dari {data[0]['jenis_kelamin']} Menjadi {new_gender}\n")

                    while True:
                        confirm_gender = input("Apakah Perubahan Jenis Kelamin Pasien Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_gender.lower() == 'ya'   :
                           data_adm_pasien[index]['jenis_kelamin'] = new_gender
                           print("Proses Update Jenis Kelamin Pasien Berhasil\n")
                           display_data_pasien(data_adm_pasien[index]['id'])
                           break

                        elif confirm_gender.lower() == 'tidak' :
                           break
                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '3':
                    new_age = input("Masukkan Usia Pasien : \n")
                    while not validate_age(new_age):
                        print("Usia Harus Berformat Integer\n")
                        new_age = input("Masukkan Usia Pasien : \n")

                    print(f"Data Usia Pasien Berubah dari {data[0]['usia']} Menjadi {new_age}")

                    while True:
                        confirm_age = input("Apakah Perubahan Usia Pasien Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_age.lower() == 'ya'   :
                           data_adm_pasien[index]['usia'] = new_age
                           print("Proses Update Usia Pasien Berhasil\n")
                           display_data_pasien(data_adm_pasien[index]['id'])
                           break

                        elif confirm_age.lower() == 'tidak' :
                           break
                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '4':
                    print("Contoh Format Alamat: Jalan Mengger Hilir, No. 1, Bandung")
                    new_address = input("Masukkan Alamat Baru Pasien : \n")

                    print(f"Data Alamat Pasien Berubah dari {data[0]['alamat']} Menjadi {new_address}")

                    while True:
                        confirm_address = input("Apakah Perubahan Alamat Pasien Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_address.lower() == 'ya'   :
                           data_adm_pasien[index]['alamat'] = new_address
                           print("Proses Update Alamat Pasien Berhasil\n")
                           display_data_pasien(data_adm_pasien[index]['id'])
                           break

                        elif confirm_address.lower() == 'tidak' :
                           break
                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '5':
                    new_occupation = input("Masukkan Pekerjaan Baru Pasien : \n")
                    while not validate_occupation(new_occupation):
                        print("Pekerjaan Hanya Terdiri dari Huruf Alfabet\n")
                        new_occupation = input("Masukkan Pekerjaan Baru Pasien : \n")

                    print(f"Data Pekerjaan Pasien Berubah dari {data[0]['pekerjaan']} Menjadi {new_occupation}")

                    while True:
                        confirm_occupation = input("Apakah Perubahan Pekerjaan Pasien Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_occupation.lower() == 'ya'   :
                           data_adm_pasien[index]['pekerjaan'] = new_occupation
                           print("Proses Update Pekerjaan Pasien Berhasil\n")
                           display_data_pasien(data_adm_pasien[index]['id'])
                           break

                        elif confirm_occupation.lower() == 'tidak' :
                           break
                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '6':
                    new_pay = input("Masukkan Jenis Pembayaran Pasien (BPJS / Tunai / Asuransi) : \n")
                    while not validate_pay(new_pay):
                        print("Jenis Pembayaran Hanya Terdiri dari BPJS / Tunai / Asuransi\n")
                        new_pay = input("Masukkan Jenis Pembayaran Pasien (BPJS / Tunai / Asuransi) : \n")

                    print(f"Data Jenis Pembayaran Pasien Berubah dari {data[0]['tipe_bayar']} Menjadi {new_pay}")

                    while True:
                        confirm_pay = input("Apakah Perubahan Jenis Pembayaran Pasien Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_pay.lower() == 'ya'   :
                           data_adm_pasien[index]['tipe_bayar'] = new_pay
                           print("Proses Update Jenis Pembayaran Pasien Berhasil\n")
                           display_data_pasien(data_adm_pasien[index]['id'])
                           break

                        elif confirm_pay.lower() == 'tidak' :
                           break
                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '7':
                    menu_update()

        elif edit_input.lower() == 'tidak' :
            menu_update()

        else :
            print("Input Tidak Valid")

### Update Data Rekam Medik Pasien Poliklinik
def update_data_poli(data):
    index = data_poli_pasien.index(data[0])
    while True :
        edit_input = input(f"Apakah Anda Ingin Meng-update Data Pasien Berdasarkan ID Pasien {data[0]['id']} (Ya / Tidak) : ")
        if edit_input.lower() == 'ya'    :
            while True:
                menu_edit = input('''
Pilih kolom yang ingin diupdate
1. Dokter
2. Keluhan
3. Kembali Ke Menu Update

Masukkan angka kolom yang ingin diupdate : ''')


                if menu_edit == '1':
                    try:
                        display_dokter()
                        print()
                        edit_poli_doctor = int(input("Masukkan Nomor Pada Daftar Dokter Poliklinik : \n"))

                    except ValueError:
                        print('Masukkan Angka yang Benar\n')

                    print(f"Data Dokter Poliklinik Berubah dari {data[0]['dokter']} Menjadi {list_dokter[edit_poli_doctor-1]['nama']}\n")

                    while True:
                        confirm_doc = input("Apakah Perubahan Data Dokter Poliklinik Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_doc.lower() == 'ya'   :
                           data_poli_pasien[index]['poli'] = list_dokter[edit_poli_doctor-1]['poli']
                           data_poli_pasien[index]['dokter'] = list_dokter[edit_poli_doctor-1]['nama']

                           print("Proses Update Data Dokter Poliklinik Berhasil\n")
                           display_pasien_poli(data_poli_pasien[index]['id'])
                           break

                        elif confirm_doc.lower() == 'tidak' :
                           break

                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '2':
                    edit_sick = input("Masukkan Keluhan Pasien : \n")
                    print(f"Data Keluhan Pasien Poliklinik Berubah dari {data[0]['keluhan']} Menjadi {edit_sick}\n")

                    while True:
                        confirm_sick = input("Apakah Perubahan Keluhan Pasien Poliklinik Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_sick.lower() == 'ya'   :
                           data_poli_pasien[index]['keluhan'] = edit_sick

                           print("Proses Update Keluhan Pasien Poliklinik Berhasil\n")
                           display_pasien_poli(data_poli_pasien[index]['id'])
                           break

                        elif confirm_sick.lower() == 'tidak' :
                           break

                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '3':
                    menu_update()

        elif edit_input.lower() == 'tidak' :
            menu_update()

        else :
            print("Input Tidak Valid")

### Update Data Rekam Medik Pasien Rawat Inap
def update_data_rawat(data):
    index = data_inap_pasien.index(data[0])
    while True :
        edit_input = input(f"Apakah Anda Ingin Meng-update Data Pasien Berdasarkan ID Pasien {data[0]['id']} (Ya / Tidak) : ")
        if edit_input.lower() == 'ya'    :
            while True:
                menu_edit = input('''
Pilih kolom yang ingin diupdate
1. Ruangan
2. Keluhan
3. Status
4. Kembali Ke Menu Update

Masukkan angka kolom yang ingin diupdate : ''')


                if menu_edit == '1':
                    try:
                        display_ruangan()
                        print()
                        edit_room = int(input("Masukkan Nomor Pada Daftar Ruangan Rawat Inap : \n"))

                    except ValueError:
                        print('Masukkan Angka yang Benar\n')

                    print(f"Data Ruangan Rawat Inap Berubah dari {data[0]['ruangan']} Menjadi {list_ruangan[edit_room-1]['ruangan']}\n")

                    while True:
                        confirm_room = input("Apakah Perubahan Data Ruangan Rawat Inap Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_room.lower() == 'ya'   :
                           data_inap_pasien[index]['ruangan'] = list_ruangan[edit_room-1]['ruangan']

                           print("Proses Update Data Ruangan Rawat Inap Berhasil\n")
                           display_pasien_rawat(data_inap_pasien[index]['id'])
                           break

                        elif confirm_room.lower() == 'tidak' :
                           break

                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '2':
                    edit_sick = input("Masukkan Keluhan Pasien : \n")
                    print(f"Data Keluhan Pasien Rawat Inap Berubah dari {data[0]['keluhan']} Menjadi {edit_sick}\n")

                    while True:
                        confirm_sick = input("Apakah Perubahan Keluhan Pasien Rawat Inap Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_sick.lower() == 'ya'   :
                           data_inap_pasien[index]['keluhan'] = edit_sick

                           print("Proses Update Keluhan Pasien Rawat Inap Berhasil\n")
                           display_pasien_rawat(data_inap_pasien[index]['id'])
                           break

                        elif confirm_sick.lower() == 'tidak' :
                           break

                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '3':
                    while True:
                        edit_status = input("Masukkan Status Pasien (Rawat / Pulang) : \n")
                        if edit_status.lower() == 'rawat' or edit_status.lower() == 'pulang'  :
                            print(f"Data Status Pasien Rawat Inap Berubah dari {data[0]['status'].capitalize()} Menjadi {edit_status.capitalize()}\n")
                            break
                        else:
                            print("Input Tidak Sesuai\n")

                    while True:
                        confirm_status = input("Apakah Perubahan Status Pasien Rawat Inap Akan Disimpan? (Ya / Tidak) : \n")
                        if confirm_status.lower() == 'ya'   :
                           data_inap_pasien[index]['status'] = edit_status

                           print("Proses Update Status Pasien Rawat Inap Berhasil\n")
                           display_pasien_rawat(data_inap_pasien[index]['id'])
                           break

                        elif confirm_status.lower() == 'tidak' :
                           break

                        else :
                           print("Input Tidak Sesuai\n")

                elif menu_edit == '4':
                    menu_update()

        elif edit_input.lower() == 'tidak' :
            menu_update()

        else :
            print("Input Tidak Valid")


## Fungsi Delete Database

### Delete Data Administrasi Pasien
def delete_data_adm(data):
    while True:
        delete_confirm = input(f"Apakah Anda Yakin Ingin Menghapus Data Administrasi Pasien dengan ID {data[0]['id']}? (Ya/Tidak) : ")
        if delete_confirm.lower() == 'ya':
            data_adm_pasien.remove(data[0])
            print("Data Administrasi Pasien Berhasil Dihapus")
            break
        elif delete_confirm.lower() == 'tidak':
            break
        else :
            print("Input Tidak Valid")

### Delete Data Rekam Medik Pasien Poliklinik
def delete_data_poli(data):
    while True:
        delete_confirm = input(f"Apakah Anda Yakin Ingin Menghapus Data Pasien Poliklinik dengan ID {data[0]['id']}? (Ya/Tidak) : ")
        if delete_confirm.lower() == 'ya':
            data_poli_pasien.remove(data[0])
            print("Data Pasien Poliklinik Berhasil Dihapus")
            break
        elif delete_confirm.lower() == 'tidak':
            break
        else :
            print("Input Tidak Valid")

### Delete Data Rekam Medik Pasien Rawat Inap
def delete_data_rawat(data):
    while True:
        delete_confirm = input(f"Apakah Anda Yakin Ingin Menghapus Data Pasien Rawat Inap dengan ID {data[0]['id']}? (Ya/Tidak) : ")
        if delete_confirm.lower() == 'ya':
            data_inap_pasien.remove(data[0])
            print("Data Pasien Rawat Inap Berhasil Dihapus")
            break
        elif delete_confirm.lower() == 'tidak':
            break
        else :
            print("Input Tidak Valid")


## Validasi Data Input

### Validasi Nama
def validate_name(name):
    if all(nm.isalpha() or nm in ' ' for nm in name) and len(name) >0:
        return True
    return False

### Validasi Jenis Kelamin
def validate_gender(gender):
    if gender.lower() in ['pria', 'wanita']:
        return True
    return False

### Validasi Usia
def validate_age(age):
    if age.isdigit():
        return True
    return False

### Validasi Pekerjaan
def validate_occupation(occupation):
    if all(ocp.isalpha() or ocp in ' ' for ocp in occupation) and len(occupation) > 0:
        return True
    return False

### Validasi Jenis Pembayaran
def validate_pay(pay):
    if pay.lower() in ['bpjs', 'tunai', 'asuransi']:
        return True
    return False

### Validasi Update Data
def validate_edit(edit):
    if edit.lower() in ['ya', 'tidak']:
        return True
    return False

## Tampilan Menu Aplikasi
### Menu Create
def menu_create():
    create_input = input('''
Menambah Data Pasien
1. Menambah Data Pasien Baru
2. Kembali Ke Menu Home

Masukkan Angka Pada Menu Sesuai yang ingin Anda Jalankan : ''')

    if create_input == '1':
        print()
        add_name = input("Masukkan Nama Pasien : \n")
        while not validate_name(add_name):
            print("Nama Hanya Terdiri dari Huruf Alfabet\n")
            add_name = input("Masukkan Nama Pasien : \n")

        add_gender = input("Masukkan Jenis Kelamin Pasien (Pria / Wanita) : \n")
        while not validate_gender(add_gender):
            print("Jenis Kelamin Hanya Dapat Diisi Pria atau Wanita\n")
            add_gender = input("Masukkan Jenis Kelamin Pasien (Pria / Wanita) : \n")

        add_age = input("Masukkan Usia Pasien : \n")
        while not validate_age(add_age):
            print("Usia Harus Berformat Integer\n")
            add_age = input("Masukkan Usia Pasien : \n")

        add_occupation = input("Masukkan Pekerjaan Pasien : \n")
        while not validate_occupation(add_occupation):
            print("Pekerjaan Hanya Terdiri dari Huruf Alfabet\n")
            add_occupation = input("Masukkan Pekerjaan Pasien : \n")

        print("Contoh Format Alamat: Jalan Mengger Hilir, No. 1, Bandung")
        add_address = input("Masukkan Alamat Pasien : \n")

        add_pay = input("Masukkan Jenis Pembayaran Pasien (BPJS / Tunai / Asuransi) : \n")
        while not validate_pay(add_pay):
            print("Jenis Pembayaran Hanya Terdiri dari BPJS / Tunai / Asuransi\n")
            add_pay = input("Masukkan Jenis Pembayaran Pasien (BPJS / Tunai / Asuransi) : \n")

        while True :
            add_visit = input("Masukkan Jenis Kunjungan Pasien (Poliklinik / Rawat) : \n")
            print()
            if add_visit.lower() == 'poliklinik':
              try:
                  display_dokter()
                  print()
                  add_poli_doctor = int(input("Masukkan Nomor Pada Daftar Dokter Poliklinik : \n"))
                  if 0<add_poli_doctor<=len(list_dokter):
                      add_sick_poli = input("Masukkan Keluhan Pasien : \n")
                      data_poli_pasien.append({'id' : data_adm_pasien[len(data_adm_pasien)-1]['id'] + 1,
                                               'poli' : list_dokter[add_poli_doctor-1]['poli'],
                                               'dokter': list_dokter[add_poli_doctor-1]['nama'],
                                               'keluhan' : add_sick_poli})
                      print()
                      break

                  else:
                      print("Dokter Tidak Ditemukan\n")
              except ValueError:
                  print('Masukkan Angka yang Benar\n')

            elif add_visit.lower() == 'rawat':
              try:
                  display_ruangan()
                  print()
                  add_room = int(input("Masukkan Nomor Pada Daftar Ruangan Rawat Inap : \n"))
                  if 0<add_room<=len(list_ruangan):
                      add_sick_rawat = input("Masukkan Keluhan Pasien : \n")
                      add_status = input("Masukkan Status Pasien (Rawat / Pulang) : \n")
                      if add_status.lower() == 'rawat' or add_status.lower() == 'pulang'  :
                         data_poli_pasien.append({'id' : data_adm_pasien[len(data_adm_pasien)-1]['id'] + 1,
                                                  'ruangan' : list_ruangan[add_room-1]['ruangan'],
                                                  'keluhan' : add_sick_rawat,
                                                  'status': add_status.capitalize()})
                         print()
                         break

                      else :
                         print("Status Pasien yang Anda Masukkan Tidak Sesuai\n")
                  else:
                      print("Nama Ruangan Tidak Ditemukan\n")
              except ValueError:
                  print('Angka yang Dimasukkan Hanya Berformat Integer\n')


            else :
                  print("Jenis Kunjungan Pasien yang Anda Masukkan Tidak Sesuai\n")

        data_adm_pasien.append({
                'id':data_adm_pasien[len(data_adm_pasien)-1]['id'] + 1 ,
                'nama':add_name.capitalize(),
                'usia':add_age,
                'jenis_kelamin':add_gender.capitalize(),
                'alamat':add_address,
                'pekerjaan':add_occupation.capitalize(),
                'tipe_kunjungan' : add_visit.capitalize() ,
                'tipe_bayar': add_pay.upper()})

        print('''
--------------------------------------------------------
  ++++ DATA PASIEN BARU TELAH BERHASIL DITAMBAHKAN ++++\n''')
        display_data_pasien()


    elif create_input == '2':
        landing_page()

    else:
        print('Menu yang Anda Pilih Tidak Tersedia\n')

    menu_create()

### Menu Read
def menu_read():
    read_input = input('''
Menampilkan Data Pasien
1. Menampilkan Seluruh Data Administrasi Pasien
2. Menampilkan Data Administrasi Pasien Berdasarkan ID Pasien
3. Kembali Ke Menu Home

Masukkan Angka Pada Menu Sesuai yang ingin Anda Jalankan : ''')

    if read_input == '1':
        display_data_pasien()

    elif read_input == '2':
        try:
            id = int(input('Masukkan ID Pasien yang Ingin Anda Lihat Data Administrasinya : \n'))
            filter_id_pasien(id)

        except ValueError:
            print('ID yang Anda Masukkan Tidak Valid\n')

    elif read_input == '3':
        landing_page()

    else:
        print('Menu yang Anda Pilih Tidak Tersedia\n')
    menu_read()

### Menu Update
def menu_update():
    update_input = input('''
Meng-update Data Pasien
1. Meng-update Data Administrasi Pasien
2. Meng-update Data Pasien Poliklinik
3. Meng-update Data Pasien Rawat Inap
4. Kembali Ke Menu Awal

Masukkan Angka Pada Menu Sesuai yang ingin Anda Jalankan : ''')

    if update_input == '1':
        try:
            display_data_pasien()
            id = int(input('Masukkan ID Pasien yang Ingin Anda Update : \n'))
            filter_id_pasien(id,'edit')

        except ValueError:
            print('ID yang Anda Masukkan Tidak Valid\n')

    elif update_input == '2':
        try:
            display_pasien_poli()
            id_poli = int(input('Masukkan ID Pasien yang Ingin Anda Update : \n'))
            filter_id_pasien_poli(id_poli,'edit')

        except ValueError:
            print('ID yang Anda Masukkan Tidak Valid\n')

    elif update_input == '3':
        try:
            display_pasien_rawat()
            id_rawat = int(input('Masukkan ID Pasien yang Ingin Anda Update : \n'))
            filter_id_pasien_rawat(id_rawat,'edit')

        except ValueError:
            print('ID yang Anda Masukkan Tidak Valid\n')

    elif update_input == '4':
        landing_page()
    else:
        print('Menu yang Anda Pilih Tidak Tersedia\n')

    menu_update()

### Menu Delete
def menu_delete():
    delete_input = input('''
Menghapus Data Pasien
1. Menghapus Data Pasien
2. Kembali Ke Menu Awal

Masukkan Angka Pada Menu Sesuai yang ingin Anda Jalankan : ''')

    if delete_input == '1':
        try:
            display_data_pasien()
            display_pasien_poli()
            display_pasien_rawat()
            id = int(input('Masukkan ID Pasien yang Ingin Anda Hapus : '))
            filter_id_pasien(id,'delete')
            filter_id_pasien_poli(id,'delete')
            filter_id_pasien_rawat(id,'delete')
            display_data_pasien()
            display_pasien_poli()
            display_pasien_rawat()
        except ValueError:
            print('ID yang Anda Masukkan Tidak Valid\n')

    elif delete_input == '2':
        landing_page()

    else:
        print('Menu yang Anda Pilih Tidak Tersedia\n')

    menu_delete()

### Menu Info Poliklinik
def info_poli() :
    info_poli_input = input('''
Menampilkan Informasi Poliklinik Rumah Sakit Umum Purwadhika
1. Menampilkan Data Pasien Poliklinik
2. Menampilkan Daftar dan Jadwal Praktik Dokter Poliklinik
3. Menampilan Data Jumlah Pasien Per Dokter
4. Kembali Ke Menu Awal

Masukkan Angka Pada Menu Sesuai yang ingin Anda Jalankan : ''')

    if info_poli_input == '1':
        display_pasien_poli()

    elif info_poli_input == '2':
        display_dokter()

    elif info_poli_input == '3':
        display_jumlah_pasien_poli()

    elif info_poli_input == '4':
        landing_page()
    else:
        print('Menu yang Anda Pilih Tidak Tersedia\n')

    info_poli()

### Menu Info Rawat Inap
def info_rawat() :
    info_rawat_input = input('''
Menampilkan Informasi Rawat Inap Rumah Sakit Umum Purwadhika
1. Menampilkan Data Pasien Rawat Inap
2. Menampilan Data Ketersediaan Ruangan Rawat Inap
3. Kembali Ke Menu Awal

Masukkan Angka Pada Menu Sesuai yang ingin Anda Jalankan : ''')

    if info_rawat_input == '1':
        display_pasien_rawat()

    elif info_rawat_input == '2':
        display_ketersediaan_rawat()

    elif info_rawat_input == '3':
        landing_page()
    else:
        print('Menu yang Anda Pilih Tidak Tersedia\n')

    info_rawat()

### Main Menu
def landing_page():
    print('''
--------------------------------------------------------
  ++++SELAMAT DATANG DI RUMAH SAKIT UMUM PURWADHIKA++++

Main Menu List:
1. Menampilkan Data Pasien
2. Menambah Data Pasien Baru
3. Meng-update Data Pasien
4. Menghapus Data Pasien
5. Informasi Poliklinik
6. Informasi Ruang Rawat Inap
7. Keluar dari Aplikasi
--------------------------------------------------------
    ''')

    option_landing_page = input('Input Main Menu (1-7): ')

    if option_landing_page == '1':
        menu_read()

    elif option_landing_page == '2':
        menu_create()

    elif option_landing_page == '3':
        menu_update()

    elif option_landing_page == '4':
        menu_delete()

    elif option_landing_page == '5':
        info_poli()

    elif option_landing_page == '6':
        info_rawat()

    elif option_landing_page == '7':
        print('\n')
        print('''++++TERIMA KASIH TELAH BERKUNJUNG KE RUMAH SAKIT UMUM PURWADHIKA++++
                      SEMOGA SEHAT SELALU''')
        exit()
    else:
        print('\n    *****Angka yang Anda Input Salah!*****')
        landing_page()


# Jalankan Aplikasi
landing_page()


